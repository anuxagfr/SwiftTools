<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SwiftTools - The All-in-One File Toolkit</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Pako.js for client-side GZIP compression -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
    <!-- JSZip for creating zip files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.0/jszip.min.js"></script>
    <!-- PDF-Lib for creating and editing PDFs -->
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }
        .drag-area-highlight {
            background-color: #e0f2fe;
            border-color: #0284c7;
        }
        .smooth-transition {
            transition: all 0.3s ease-in-out;
        }
        .tool-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .tool-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .dropdown:hover .dropdown-menu {
            display: block;
        }
          .plan-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .plan-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .locked-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            border-radius: 0.5rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }
        .tool-card:hover .locked-overlay {
            opacity: 1;
        }
        #toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 12px 24px;
            border-radius: 8px;
            color: white;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.5s, bottom 0.5s;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <!-- Navigation Bar -->
    <nav class="bg-white/90 backdrop-blur-sm shadow-md border-b border-slate-200 sticky top-0 z-30">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex-shrink-0 flex items-center">
                    <svg class="h-8 w-auto text-indigo-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 01-2.25 2.25M16.5 7.5V18a2.25 2.25 0 002.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 002.25 2.25h13.5M6 7.5h3v3H6v-3z" />
                    </svg>
                    <a href="#" id="homeLink" class="ml-2 text-xl font-bold text-slate-800">SwiftTools</a>
                </div>
                 <div class="hidden md:flex items-center space-x-2">
                    <a href="#" id="allToolsLink" class="text-slate-600 hover:text-indigo-600 px-3 py-2 rounded-md text-sm font-medium">All Tools</a>
                    <a href="#" class="text-slate-600 hover:text-indigo-600 bg-slate-100 px-3 py-2 rounded-md text-sm font-medium tool-link" data-tool="compressor">Compressor</a>

                    <div class="dropdown relative">
                         <button class="text-slate-600 hover:text-indigo-600 px-3 py-2 rounded-md text-sm font-medium flex items-center">
                            Organize
                            <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                         </button>
                         <div class="dropdown-menu absolute hidden bg-white shadow-lg rounded-md mt-2 w-48 border border-slate-200">
                             <a href="#" class="block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 tool-link" data-tool="Merge PDF">Merge PDF</a>
                             <a href="#" class="block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 tool-link" data-tool="Split PDF">Split PDF</a>
                             <a href="#" class="block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 tool-link" data-tool="Organize PDF">Organize PDF</a>
                         </div>
                    </div>
                    <div class="dropdown relative">
                         <button class="text-slate-600 hover:text-indigo-600 px-3 py-2 rounded-md text-sm font-medium flex items-center">
                            Convert
                            <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                         </button>
                         <div class="dropdown-menu absolute hidden bg-white shadow-lg rounded-md mt-2 w-48 border border-slate-200">
                             <a href="#" class="block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 tool-link" data-tool="PDF to Word">PDF to Word</a>
                             <a href="#" class="block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 tool-link" data-tool="Word to PDF">Word to PDF</a>
                             <a href="#" class="block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 tool-link" data-tool="PDF to JPG">PDF to JPG</a>
                             <a href="#" class="block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 tool-link" data-tool="JPG to PDF">JPG to PDF</a>
                         </div>
                    </div>
                    <div class="dropdown relative">
                         <button class="text-slate-600 hover:text-indigo-600 px-3 py-2 rounded-md text-sm font-medium flex items-center">
                            Security
                             <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                         </button>
                         <div class="dropdown-menu absolute hidden bg-white shadow-lg rounded-md mt-2 w-48 border border-slate-200">
                             <a href="#" class="block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 tool-link" data-tool="Sign PDF">Sign PDF</a>
                             <a href="#" class="block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 tool-link" data-tool="Unlock PDF">Unlock PDF</a>
                             <a href="#" class="block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 tool-link" data-tool="Protect PDF">Protect PDF</a>
                         </div>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-2 bg-indigo-100 text-indigo-700 font-semibold px-3 py-1.5 rounded-full">
                        <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                           <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5c0 .414.336.75.75.75h4a.75.75 0 000-1.5h-3.25V5z" clip-rule="evenodd" />
                        </svg>
                        <span>Credits: <span id="credit-count">00</span></span>
                    </div>

                
                <div id="auth-links" class="hidden md:flex items-center space-x-2">
                    <button id="loginBtn" class="text-slate-600 hover:text-indigo-600 px-3 py-2 rounded-md text-sm font-medium">Login</button>
                    <button id="signupBtn" class="bg-indigo-600 text-white hover:bg-indigo-700 px-4 py-2 rounded-md text-sm font-medium">Sign Up</button>
                </div>             <!-- Profile Picture -->
                    <div id="profile-container" class="w-10 h-10 rounded-full bg-slate-200 flex items-center justify-center overflow-hidden">
                        <img id="profile-img" src="" alt="Profile Picture" class="hidden h-full w-full object-cover">
                        <svg id="default-avatar" class="h-6 w-6 text-slate-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" />
                        </svg>
                    </div>
                       
                </div>
            </div>

                 <!-- <div id="account-links" class="hidden md:flex items-center space-x-4">
                    <button class="coming-soon-btn text-slate-600 hover:text-indigo-600 px-3 py-2 rounded-md text-sm font-medium">My Account</button>
                    <button id="logoutBtn" class="text-slate-600 hover:text-indigo-600 px-3 py-2 rounded-md text-sm font-medium">Log Out</button>
                </div> -->
            </div>
        </div>
    </nav>

    <main class="w-full max-w-7xl mx-auto p-4 md:p-8">
        <!-- Compressor Section -->
        <section id="compressor" class="main-section mb-20">
            <div class="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden max-w-5xl mx-auto">
                <header class="text-center p-6 border-b border-slate-200">
                    <h1 class="text-3xl font-bold text-slate-900">File Compressor</h1>
                    <p class="text-slate-500 mt-2">Compress single or multiple files at once. Fast, private, and free.</p>
                </header>
                <div class="p-6 md:p-8">
                    <div id="uploadSelection">
                         <div class="grid md:grid-cols-2 gap-8 items-center">
                            <div id="uploadArea" class="relative block w-full h-full min-h-[300px] rounded-lg border-2 border-dashed border-slate-300 p-6 text-center hover:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 smooth-transition flex flex-col justify-center items-center">
                                <svg class="mx-auto h-12 w-12 text-slate-400" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true">
                                    <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                </svg>
                                <span class="mt-4 block text-sm font-semibold text-slate-700">Drag & Drop File(s) Here</span>
                                <span class="mt-1 block text-xs text-slate-500">Supports Images, PDF, TXT, and more</span>
                            </div>
                            <div class="space-y-3">
                                <button id="deviceBtn" class="w-full flex items-center justify-center text-center p-4 bg-indigo-600 text-white rounded-lg shadow-sm hover:bg-indigo-700 smooth-transition font-semibold">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z" clip-rule="evenodd" /></svg>
                                    Choose File(s) from Device
                                </button>
                                <div class="grid grid-cols-2 gap-3">
                                    <button id="urlBtn" class="w-full flex items-center p-3 bg-slate-100 hover:bg-slate-200 rounded-lg smooth-transition text-sm font-medium">
                                       <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-slate-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0m-2.828-2.828a2 2 0 012.828 0l3 3a2 2 0 010 2.828l-3 3a2 2 0 01-2.828-2.828l3-3a2 2 0 010-2.828zM10 5a1 1 0 100-2 1 1 0 000 2zM10 15a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd" /></svg>
                                       Add from URL
                                    </button>
                                    <button id="clipboardBtn" class="w-full flex items-center p-3 bg-slate-100 hover:bg-slate-200 rounded-lg smooth-transition text-sm font-medium">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-slate-500" viewBox="0 0 20 20" fill="currentColor"><path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" /><path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" /></svg>
                                        Paste Image
                                    </button>
                                </div>
                                 <div class="relative">
                                    <div class="absolute inset-0 flex items-center" aria-hidden="true"><div class="w-full border-t border-slate-300"></div></div>
                                    <div class="relative flex justify-center"><span class="bg-white px-2 text-xs text-slate-500">Cloud Storage</span></div>
                                </div>
                                <div class="grid grid-cols-3 gap-3">
                                     <button class="cloud-btn w-full flex items-center p-3 bg-slate-100 hover:bg-slate-200 rounded-lg smooth-transition text-sm font-medium opacity-60 cursor-not-allowed">
                                        <img src="https://placehold.co/20x20/4285F4/FFFFFF?text=G" class="w-5 h-5 mr-2" alt="Google Drive icon"> Drive
                                     </button>
                                     <button class="cloud-btn w-full flex items-center p-3 bg-slate-100 hover:bg-slate-200 rounded-lg smooth-transition text-sm font-medium opacity-60 cursor-not-allowed">
                                         <img src="https://placehold.co/20x20/0061FE/FFFFFF?text=D" class="w-5 h-5 mr-2" alt="Dropbox icon"> Dropbox
                                     </button>
                                     <button class="cloud-btn w-full flex items-center p-3 bg-slate-100 hover:bg-slate-200 rounded-lg smooth-transition text-sm font-medium opacity-60 cursor-not-allowed">
                                        <img src="https://placehold.co/20x20/0078D4/FFFFFF?text=O" class="w-5 h-5 mr-2" alt="OneDrive icon"> OneDrive
                                     </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="processingArea" class="hidden">
                        <!-- This section is populated by JS -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Generic Tool Section -->
        <section id="generic-tool-section" class="main-section hidden mb-20">
            <div class="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden max-w-5xl mx-auto">
                <header class="text-center p-6 border-b border-slate-200">
                    <h1 id="tool-title" class="text-3xl font-bold text-slate-900">Tool Name</h1>
                    <p id="tool-subtitle" class="text-slate-500 mt-2">Tool subtitle description.</p>
                </header>
                <div id="tool-content" class="p-6 md:p-8">
                    <!-- Tool-specific UI will be injected here -->
                </div>
            </div>
        </section>
 
        <!-- Home Section -->
        <section id="home" class="main-section">
            <div class="text-center py-16">
                <h1 class="text-4xl md:text-6xl font-extrabold text-slate-900 tracking-tight">Your Complete Online File Toolkit</h1>
                <p class="mt-6 max-w-3xl mx-auto text-lg text-slate-600">Effortlessly compress, convert, organize, and edit your files with a comprehensive suite of powerful tools. All processing is done securely in your browser.</p>
                <div class="mt-8">
                    <a href="#" class="tool-link inline-block bg-indigo-600 text-white font-semibold py-3 px-8 rounded-lg shadow-lg hover:bg-indigo-700 smooth-transition" data-tool="compressor">Start with our Free Compressor</a>
                </div>
            </div>

            <div id="all-tools-grid" class="py-16">
                 <div class="grid grid-cols-1 md:grid-cols-12 gap-8">
                    
                    <!-- Left Column: Compress, Convert, AI -->
                    <div class="md:col-span-3 space-y-8">
                        <div>
                            <h3 class="text-sm font-semibold text-slate-500 uppercase tracking-wider mb-4">Compress</h3>
                            <a href="#" class="tool-link flex items-center gap-3" data-tool="compressor"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-red-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 9V4.5M9 9H4.5M9 9L3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9h4.5M15 9V4.5M15 9l5.25-5.25M15 15h4.5M15 15v4.5M15 15l5.25 5.25" /></svg></div><span class="font-medium text-sm">Compress PDF</span></a>
                        </div>
                         <div>
                            <h3 class="text-sm font-semibold text-slate-500 uppercase tracking-wider mb-4">Convert</h3>
                            <a href="#" class="tool-link flex items-center gap-3" data-tool="PDF Converter"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-red-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M7.5 21 3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5" /></svg></div><span class="font-medium text-sm">PDF Converter</span></a>
                        </div>
                        <div>
                            <h3 class="text-sm font-semibold text-slate-500 uppercase tracking-wider mb-4">AI PDF</h3>
                             <div class="space-y-4">
                                <a href="#" class="tool-link flex items-center gap-3" data-tool="AI PDF Assistant"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-blue-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456Z" /></svg></div><span class="font-medium text-sm">AI PDF Assistant</span></a>
                                <a href="#" class="tool-link flex items-center gap-3" data-tool="Chat with PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-blue-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.76 9.76 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z" /></svg></div><span class="font-medium text-sm">Chat with PDF</span></a>
                                <a href="#" class="tool-link flex items-center gap-3" data-tool="AI PDF Summarizer"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-blue-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" /></svg></div><span class="font-medium text-sm">AI PDF Summarizer</span></a>
                                <a href="#" class="tool-link flex items-center gap-3" data-tool="Translate PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-blue-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m10.5 21 5.25-11.25L21 21m-9-3h7.5M3 5.621a48.474 48.474 0 0 1 6-.371m0 0c1.12 0 2.233.038 3.334.114M9 5.25V3m3.334 2.364C11.176 10.658 7.69 15.08 3 17.502" /></svg></div><span class="font-medium text-sm">Translate PDF</span></a>
                                <a href="#" class="tool-link flex items-center gap-3" data-tool="AI Question Generator"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-blue-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z" /></svg></div><span class="font-medium text-sm">AI Question Generator</span></a>
                            </div>
                        </div>
                    </div>

                    <!-- Right Columns: All other tools -->
                    <div class="md:col-span-9 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                        <div>
                            <h3 class="text-sm font-semibold text-slate-500 uppercase tracking-wider mb-4">Organize</h3>
                            <div class="space-y-4">
                                 <a href="#" class="tool-link flex items-center gap-3" data-tool="Merge PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-purple-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 9.75h16.5m-16.5 4.5h16.5m-16.5 4.5h16.5m-16.5-1.5a1.5 1.5 0 0 1-1.5-1.5V6.75A1.5 1.5 0 0 1 3.75 5.25h16.5a1.5 1.5 0 0 1 1.5 1.5v10.5a1.5 1.5 0 0 1-1.5 1.5H3.75Z" /></svg></div><span class="font-medium text-sm">Merge PDF</span></a>
                                 <a href="#" class="tool-link flex items-center gap-3" data-tool="Split PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-purple-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m-4.875-6.375h9.75" /><path d="M19.5 21a2.25 2.25 0 0 0 2.25-2.25V5.25A2.25 2.25 0 0 0 19.5 3H4.5A2.25 2.25 0 0 0 2.25 5.25v13.5A2.25 2.25 0 0 0 4.5 21h15Z" stroke-dasharray="3 3" stroke-linecap="round" stroke-linejoin="round" /></svg></div><span class="font-medium text-sm">Split PDF</span></a>
                                 <a href="#" class="tool-link flex items-center gap-3" data-tool="Rotate PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-purple-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15 15l-6 6m0 0l-6-6m6 6V9a6 6 0 0 1 12 0v3" /></svg></div><span class="font-medium text-sm">Rotate PDF</span></a>
                                 <a href="#" class="tool-link flex items-center gap-3" data-tool="Remove Pages"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-purple-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15 12H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" /></svg></div><span class="font-medium text-sm">Delete Pages</span></a>
                                 <a href="#" class="tool-link flex items-center gap-3" data-tool="Extract Pages"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-purple-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6A2.25 2.25 0 0 0 5.25 5.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9" /></svg></div><span class="font-medium text-sm">Extract Pages</span></a>
                                 <a href="#" class="tool-link flex items-center gap-3" data-tool="Organize PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-purple-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12" /></svg></div><span class="font-medium text-sm">Organize PDF</span></a>
                            </div>
                        </div>
                        
                        <div>
                            <h3 class="text-sm font-semibold text-slate-500 uppercase tracking-wider mb-4">View & Edit</h3>
                            <div class="space-y-4">
                                 <a href="#" class="tool-link flex items-center gap-3" data-tool="Edit PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-teal-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Z" /></svg></div><span class="font-medium text-sm">Edit PDF</span></a>
                                 <a href="#" class="tool-link flex items-center gap-3" data-tool="PDF Annotator"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-teal-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125" /></svg></div><span class="font-medium text-sm">PDF Annotator</span></a>
                                 <a href="#" class="tool-link flex items-center gap-3" data-tool="PDF Reader"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-teal-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" /></svg></div><span class="font-medium text-sm">PDF Reader</span></a>
                                 <a href="#" class="tool-link flex items-center gap-3" data-tool="Number Pages"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-teal-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12H12m-8.25 5.25h16.5" /></svg></div><span class="font-medium text-sm">Number Pages</span></a>
                                 <a href="#" class="tool-link flex items-center gap-3" data-tool="Crop PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-teal-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M7.5 3.75H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V6a2.25 2.25 0 0 0-2.25-2.25h-3m-9.75 0v15m0-15H15" /></svg></div><span class="font-medium text-sm">Crop PDF</span></a>
                                 <a href="#" class="tool-link flex items-center gap-3" data-tool="Redact PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-teal-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" /></svg></div><span class="font-medium text-sm">Redact PDF</span></a>
                                 <a href="#" class="tool-link flex items-center gap-3" data-tool="Watermark"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-teal-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 8.25h15m-16.5 7.5h15m-1.8-13.5l-3.9 19.5m-2.1-19.5l-3.9 19.5" /></svg></div><span class="font-medium text-sm">Watermark</span></a>
                                 <a href="#" class="tool-link flex items-center gap-3" data-tool="PDF Form Filler"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-teal-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125" /></svg></div><span class="font-medium text-sm">PDF Form Filler</span></a>
                                 <a href="#" class="tool-link flex items-center gap-3" data-tool="Share PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-teal-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 0-2.186m0 2.186c-.18.324-.283.696-.283 1.093s.103.77.283 1.093m0-2.186 9.566-5.314m0 0a2.25 2.25 0 1 0 0-2.186m0 2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093Z" /></svg></div><span class="font-medium text-sm">Share PDF</span></a>
                            </div>
                        </div>
                        
                        <div class="space-y-8">
                            <div>
                                <h3 class="text-sm font-semibold text-slate-500 uppercase tracking-wider mb-4">Convert from PDF</h3>
                                <div class="space-y-4">
                                     <a href="#" class="tool-link flex items-center gap-3" data-tool="PDF to Word"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-blue-600 rounded-lg text-white font-bold">W</div><span class="font-medium text-sm">PDF to Word</span></a>
                                     <a href="#" class="tool-link flex items-center gap-3" data-tool="PDF to Excel"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-green-600 rounded-lg text-white font-bold">X</div><span class="font-medium text-sm">PDF to Excel</span></a>
                                     <a href="#" class="tool-link flex items-center gap-3" data-tool="PDF to PowerPoint"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-orange-500 rounded-lg text-white font-bold">P</div><span class="font-medium text-sm">PDF to PPT</span></a>
                                     <a href="#" class="tool-link flex items-center gap-3" data-tool="PDF to JPG"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-yellow-500 rounded-lg text-white font-bold">JPG</div><span class="font-medium text-sm">PDF to JPG</span></a>
                                </div>
                            </div>
                             <div>
                                <h3 class="text-sm font-semibold text-slate-500 uppercase tracking-wider mb-4">Convert to PDF</h3>
                                <div class="space-y-4">
                                     <a href="#" class="tool-link flex items-center gap-3" data-tool="Word to PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-blue-600 rounded-lg text-white font-bold">W</div><span class="font-medium text-sm">Word to PDF</span></a>
                                     <a href="#" class="tool-link flex items-center gap-3" data-tool="Excel to PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-green-600 rounded-lg text-white font-bold">X</div><span class="font-medium text-sm">Excel to PDF</span></a>
                                     <a href="#" class="tool-link flex items-center gap-3" data-tool="PowerPoint to PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-orange-500 rounded-lg text-white font-bold">P</div><span class="font-medium text-sm">PPT to PDF</span></a>
                                     <a href="#" class="tool-link flex items-center gap-3" data-tool="JPG to PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-yellow-500 rounded-lg text-white font-bold">JPG</div><span class="font-medium text-sm">JPG to PDF</span></a>
                                     <a href="#" class="tool-link flex items-center gap-3" data-tool="OCR PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-red-800 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 3.75 9.375v-4.5ZM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 0 1-1.125-1.125v-4.5ZM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 13.5 9.375v-4.5Z" /><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 6.75h.75v.75h-.75v-.75ZM6.75 16.5h.75v.75h-.75v-.75ZM16.5 6.75h.75v.75h-.75v-.75ZM13.5 13.5v4.5a1.125 1.125 0 0 0 1.125 1.125h4.5a1.125 1.125 0 0 0 1.125-1.125v-4.5A1.125 1.125 0 0 0 19.125 12h-4.5A1.125 1.125 0 0 0 13.5 13.5Z" /></svg></div><span class="font-medium text-sm">PDF OCR</span></a>
                                </div>
                            </div>
                        </div>

                        <div class="space-y-8">
                             <div>
                                <h3 class="text-sm font-semibold text-slate-500 uppercase tracking-wider mb-4">Sign</h3>
                                <div class="space-y-4">
                                     <a href="#" class="tool-link flex items-center gap-3" data-tool="Sign PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-pink-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" /></svg></div><span class="font-medium text-sm">Sign PDF</span></a>
                                     <a href="#" class="tool-link flex items-center gap-3" data-tool="Request Signatures"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-yellow-400 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 0 1-2.25 2.25M16.5 7.5V18a2.25 2.25 0 0 0 2.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 0 0 2.25 2.25h13.5M6 7.5h3v3H6v-3z" /></svg></div><span class="font-medium text-sm">Request Signatures</span></a>
                                </div>
                            </div>
                            <div>
                                <h3 class="text-sm font-semibold text-slate-500 uppercase tracking-wider mb-4">More</h3>
                                <div class="space-y-4">
                                     <a href="#" class="tool-link flex items-center gap-3" data-tool="Unlock PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-pink-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-9.75 0A2.25 2.25 0 0 1 6 10.5h9.75a2.25 2.25 0 0 1 2.25 2.25v3.75a2.25 2.25 0 0 1-2.25 2.25H5.25a2.25 2.25 0 0 1-2.25-2.25V10.5Z" /></svg></div><span class="font-medium text-sm">Unlock PDF</span></a>
                                     <a href="#" class="tool-link flex items-center gap-3" data-tool="Protect PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-pink-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z" /></svg></div><span class="font-medium text-sm">Protect PDF</span></a>
                                     <a href="#" class="tool-link flex items-center gap-3" data-tool="Flatten PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-pink-500 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 17.25v1.007a3 3 0 0 1-.375.364l-3.422 3.422a.75.75 0 1 1-1.06-1.06l3.422-3.422a3 3 0 0 1 .364-.375h1.007M9 17.25a3 3 0 0 0 3 3h.007v.007a3 3 0 0 0 3-3v-1.007a3 3 0 0 0 .364-.375l3.422-3.422a.75.75 0 1 0-1.06-1.06l-3.422 3.422a3 3 0 0 0-.375.364V17.25Z" /></svg></div><span class="font-medium text-sm">Flatten PDF</span></a>
                                </div>
                            </div>
                             <div>
                                <h3 class="text-sm font-semibold text-slate-500 uppercase tracking-wider mb-4">Scan</h3>
                                <div class="space-y-4">
                                     <a href="#" class="tool-link flex items-center gap-3" data-tool="Scan to PDF"><div class="tool-icon-bg flex-shrink-0 h-10 w-10 flex items-center justify-center bg-blue-800 rounded-lg text-white"><svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.776 48.776 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z" /><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z" /></svg></div><span class="font-medium text-sm">PDF Scanner</span></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    <!-- Download Modal -->
    <div id="download-modal" class="fixed inset-0 bg-black bg-opacity-50 z-[100] hidden items-center justify-center p-4">
        <div class="bg-white rounded-lg p-8 max-w-sm w-full shadow-xl">
            <h3 class="text-xl font-bold mb-2" id="modal-title">Confirm Action</h3>
            <p class="text-slate-600 mb-6">Your file is ready. Clicking download will use <strong id="modal-credit-cost">X</strong> credit(s).</p>
            <div class="flex justify-end space-x-4">
                <button id="modal-close-btn" class="px-4 py-2 bg-slate-200 text-slate-800 rounded-md hover:bg-slate-300 transition">Cancel</button>
                <button id="modal-download-btn" class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition">Download File</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast"></div>
        <!-- Pricing Section -->
        <section id="pricing-section" class="mt-20">
            <div class="text-center">
                <h2 class="text-3xl font-bold">Flexible Plans for Everyone</h2>
                <p class="mt-4 text-lg text-slate-600">Choose a credit pack that suits your needs. Get started for free!</p>
            </div>

            <div class="mt-12 grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- Plan 1 -->
                <div class="plan-card border border-slate-200 rounded-lg p-8 bg-white flex flex-col">
                    <h3 class="text-xl font-semibold">Starter</h3>
                    <p class="text-slate-500 mt-2">Perfect for occasional use.</p>
                    <div class="mt-6">
                        <span class="text-4xl font-bold">₹49</span>
                    </div>
                    <ul class="mt-8 space-y-4 text-slate-600 flex-grow">
                        <li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.052-.143z" clip-rule="evenodd" /></svg>50 Credits</li>
                    </ul>
                    <button class="buy-btn mt-8 w-full bg-slate-200 text-slate-800 font-semibold py-3 rounded-lg hover:bg-slate-300 transition" data-credits="50" data-price="49">Buy Now</button>
                </div>

                <!-- Plan 2 (Most Popular) -->
                <div class="plan-card border-2 border-indigo-600 rounded-lg p-8 bg-white relative flex flex-col">
                    <span class="absolute top-0 -translate-y-1/2 bg-indigo-600 text-white text-xs font-semibold px-3 py-1 rounded-full">MOST POPULAR</span>
                    <h3 class="text-xl font-semibold">Pro</h3>
                    <p class="text-slate-500 mt-2">For frequent users and professionals.</p>
                    <div class="mt-6">
                        <span class="text-4xl font-bold">₹199</span>
                    </div>
                    <ul class="mt-8 space-y-4 text-slate-600 flex-grow">
                        <li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.052-.143z" clip-rule="evenodd" /></svg>250 Credits</li>
                         <li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.052-.143z" clip-rule="evenodd" /></svg>Access to All Tools</li>
                    </ul>
                    <button class="buy-btn mt-8 w-full bg-indigo-600 text-white font-semibold py-3 rounded-lg hover:bg-indigo-700 transition" data-credits="250" data-price="199">Buy Now</button>
                </div>

                <!-- Plan 3 -->
                <div class="plan-card border border-slate-200 rounded-lg p-8 bg-white flex flex-col">
                    <h3 class="text-xl font-semibold">Power</h3>
                    <p class="text-slate-500 mt-2">For heavy-duty tasks and teams.</p>
                    <div class="mt-6">
                        <span class="text-4xl font-bold">₹599</span>
                    </div>
                    <ul class="mt-8 space-y-4 text-slate-600 flex-grow">
                        <li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.052-.143z" clip-rule="evenodd" /></svg>1000 Credits</li>
                         <li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.052-.143z" clip-rule="evenodd" /></svg>Priority Support</li>
                    </ul>
                    <button class="buy-btn mt-8 w-full bg-slate-200 text-slate-800 font-semibold py-3 rounded-lg hover:bg-slate-300 transition" data-credits="1000" data-price="599">Buy Now</button>
                </div>
            </div>
        </section>
    

        <!-- Compressor Section -->
        <section id="compressor" class="main-section hidden mb-20">
            <!-- Compressor HTML -->
        </section>

        <!-- Generic Tool Section -->
        <section id="generic-tool-section" class="main-section hidden mb-20">
            <!-- Generic Tool HTML -->
        </section>
    </main>
    
    <input type="file" id="fileUploadInput" class="hidden" multiple>
    
    <!-- Modals -->
    <div id="urlModal" class="modal hidden"></div>
    <div id="comingSoonModal" class="modal hidden"></div>
    <div id="loginModal" class="modal hidden"></div>
    <div id="signupModal" class="modal hidden"></div>
    <div id="myAccountModal" class="modal hidden"></div>
    <div id="cloudPickerModal" class="modal hidden"></div>

    <footer class="bg-white border-t border-slate-200">
        <div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-8">
                <div class="col-span-2 lg:col-span-1">
                     <div class="flex-shrink-0 flex items-center">
                        <svg class="h-8 w-auto text-indigo-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 01-2.25 2.25M16.5 7.5V18a2.25 2.25 0 002.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 002.25 2.25h13.5M6 7.5h3v3H6v-3z" /></svg>
                        <span class="ml-2 text-xl font-bold text-slate-800">SwiftTools</span>
                    </div>
                    <p class="mt-4 text-sm text-slate-500">Your all-in-one file toolkit.</p>
                </div>
                <div>
                    <h3 class="text-sm font-semibold text-slate-900 tracking-wider uppercase">Product</h3>
                    <ul class="mt-4 space-y-4">
                        <li><a href="#" class="text-base text-slate-500 hover:text-slate-900">Home</a></li>
                        <li><a href="#" class="text-base text-slate-500 hover:text-slate-900">Features</a></li>
                        <li><a href="#" class="text-base text-slate-500 hover:text-slate-900">Pricing</a></li>
                        <li><a href="#" class="text-base text-slate-500 hover:text-slate-900">Tools</a></li>
                        <li><a href="#" class="text-base text-slate-500 hover:text-slate-900">FAQ</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-sm font-semibold text-slate-900 tracking-wider uppercase">Resources</h3>
                    <ul class="mt-4 space-y-4">
                        <li><a href="#" class="text-base text-slate-500 hover:text-slate-900">Desktop App</a></li>
                        <li><a href="#" class="text-base text-slate-500 hover:text-slate-900">Mobile App</a></li>
                        <li><a href="#" class="text-base text-slate-500 hover:text-slate-900">API</a></li>
                    </ul>
                </div>
                 <div>
                    <h3 class="text-sm font-semibold text-slate-900 tracking-wider uppercase">Solutions</h3>
                    <ul class="mt-4 space-y-4">
                        <li><a href="#" class="text-base text-slate-500 hover:text-slate-900">Business</a></li>
                        <li><a href="#" class="text-base text-slate-500 hover:text-slate-900">Education</a></li>
                        <li><a href="#" class="text-base text-slate-500 hover:text-slate-900">Legal</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-sm font-semibold text-slate-900 tracking-wider uppercase">Company</h3>
                    <ul class="mt-4 space-y-4">
                        <li><a href="#" class="text-base text-slate-500 hover:text-slate-900">About us</a></li>
                        <li><a href="#" class="text-base text-slate-500 hover:text-slate-900">Contact us</a></li>
                        <li><a href="#" class="text-base text-slate-500 hover:text-slate-900">Blog</a></li>
                        <li><a href="#" class="text-base text-slate-500 hover:text-slate-900">Press</a></li>
                    </ul>
                </div>
                 <div>
                    <h3 class="text-sm font-semibold text-slate-900 tracking-wider uppercase">Legal</h3>
                    <ul class="mt-4 space-y-4">
                        <li><a href="#" class="text-base text-slate-500 hover:text-slate-900">Privacy Policy</a></li>
                        <li><a href="#" class="text-base text-slate-500 hover:text-slate-900">Terms & Conditions</a></li>
                        <li><a href="#" class="text-base text-slate-500 hover:text-slate-900">Cookies</a></li>
                    </ul>
                </div>
            </div>
            <div class="mt-8 border-t border-slate-200 pt-8 text-center">
                <p class="text-base text-slate-400">&copy; 2025 SwiftTools. All rights reserved.</p>
            </div>
        </div>
    </footer>
    
    <input type="file" id="fileUploadInput" class="hidden" multiple>
    
    <div id="urlModal" class="modal hidden fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4">
         <div class="bg-white rounded-xl shadow-2xl w-full max-w-md">
            <h3 class="text-lg font-semibold text-slate-800 p-4 border-b">Enter File URL</h3>
            <div class="p-4">
                <input type="url" id="urlInput" placeholder="https://example.com/image.jpg" class="block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 text-sm p-2">
                <p class="text-xs text-slate-500 mt-2">Note: This only works for URLs with permissive CORS headers.</p>
            </div>
            <div class="flex justify-end gap-3 p-4 bg-slate-50 rounded-b-xl">
                <button type="button" class="modal-close-btn bg-white hover:bg-slate-100 border border-slate-300 text-slate-700 font-semibold py-2 px-4 rounded-lg text-sm">Cancel</button>
                <button type="submit" id="submitUrlBtn" class="bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-indigo-700 text-sm">Fetch File</button>
            </div>
        </div>
    </div>
    <div id="comingSoonModal" class="modal hidden fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-sm text-center p-6">
            <h3 class="text-lg font-semibold text-slate-800">Feature Coming Soon!</h3>
            <p class="mt-2 text-sm text-slate-600">We're working hard to bring this tool to you. Please check back later.</p>
            <button class="modal-close-btn mt-6 w-full bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">Got it</button>
        </div>
    </div>
    <div id="loginModal" class="modal hidden fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-sm">
            <h3 class="text-lg font-semibold text-slate-800 p-4 border-b">Login</h3>
            <form id="loginForm" class="p-4 space-y-4">
                <div><label for="login-email" class="block text-sm font-medium">Email</label><input type="email" id="login-email" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm" required></div>
                <div><label for="login-password" class="block text-sm font-medium">Password</label><input type="password" id="login-password" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm" required></div>
                <div class="flex justify-end gap-3 pt-2">
                    <button type="button" class="modal-close-btn bg-white hover:bg-slate-100 border border-slate-300 text-slate-700 font-semibold py-2 px-4 rounded-lg text-sm">Cancel</button>
                    <button type="submit" class="bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-indigo-700 text-sm">Login</button>
                </div>
            </form>
        </div>
    </div>
     <div id="signupModal" class="modal hidden fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-sm">
            <h3 class="text-lg font-semibold text-slate-800 p-4 border-b">Sign Up to Access All Tools</h3>
            <form id="signupForm" class="p-4 space-y-4">
                <div><label for="signup-email" class="block text-sm font-medium">Email</label><input type="email" id="signup-email" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm" required></div>
                <div><label for="signup-password" class="block text-sm font-medium">Password</label><input type="password" id="signup-password" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm" required></div>
                <div class="flex justify-end gap-3 pt-2">
                    <button type="button" class="modal-close-btn bg-white hover:bg-slate-100 border border-slate-300 text-slate-700 font-semibold py-2 px-4 rounded-lg text-sm">Cancel</button>
                    <button type="submit" class="bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-indigo-700 text-sm">Create Account</button>
                </div>
            </form>
        </div>
    </div>


    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, GoogleAuthProvider, signInWithPopup, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, onSnapshot, updateDoc, increment } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        // --- CONFIGURATION ---
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : { apiKey: "YOUR_API_KEY", authDomain: "YOUR_AUTH_DOMAIN", projectId: "YOUR_PROJECT_ID" };
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-swift-tools';
        
        const FREE_TOKENS_ANONYMOUS = 10;
        const FREE_TOKENS_ON_SIGNUP = 5;

        // --- DOM ELEMENTS ---
        const creditCountEl = document.getElementById('credit-count');
        const authButton = document.getElementById('auth-button');
        const toastEl = document.getElementById('toast');
        const downloadModal = document.getElementById('download-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalCreditCost = document.getElementById('modal-credit-cost');
        const modalCloseBtn = document.getElementById('modal-close-btn');
        const modalDownloadBtn = document.getElementById('modal-download-btn');
        const profileImg = document.getElementById('profile-img');
        const defaultAvatar = document.getElementById('default-avatar');
        
        // --- FIREBASE INITIALIZATION ---
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let currentUser = null;
        let userId = null;
        let userDocUnsubscribe = null;

        // --- UI FUNCTIONS ---
        function showToast(message, isError = false) {
            toastEl.textContent = message;
            toastEl.style.backgroundColor = isError ? '#ef4444' : '#22c55e'; // red-500 or green-500
            toastEl.style.opacity = 1;
            toastEl.style.bottom = '40px';
            setTimeout(() => {
                toastEl.style.opacity = 0;
                toastEl.style.bottom = '20px';
            }, 3000);
        }

        function updateUIForAuthState(user) {
            const toolCards = document.querySelectorAll('.tool-card');
            if (user && !user.isAnonymous) {
                authButton.textContent = 'Logout';
                if (user.photoURL) {
                    profileImg.src = user.photoURL;
                    profileImg.classList.remove('hidden');
                    defaultAvatar.classList.add('hidden');
                } else {
                    profileImg.classList.add('hidden');
                    defaultAvatar.classList.remove('hidden');
                }
                toolCards.forEach(card => {
                    const overlay = card.querySelector('.locked-overlay');
                    if(overlay) overlay.style.display = 'none';
                });
            } else {
                authButton.textContent = 'Login with Google';
                profileImg.src = '';
                profileImg.classList.add('hidden');
                defaultAvatar.classList.remove('hidden');
                 toolCards.forEach(card => {
                    const overlay = card.querySelector('.locked-overlay');
                    if (overlay) overlay.style.display = 'flex';
                });
            }
        }

        // --- AUTHENTICATION ---
        onAuthStateChanged(auth, async (user) => {
            if (userDocUnsubscribe) userDocUnsubscribe();

            if (user) {
                currentUser = user;
                userId = user.uid;
                await initializeUserData(user);
                updateUIForAuthState(user);
            } else {
                signInAnonymously(auth).catch(error => console.error("Anonymous sign-in failed:", error));
            }
        });

        authButton.addEventListener('click', () => {
            if (currentUser && !currentUser.isAnonymous) {
                signOut(auth);
            } else {
                const provider = new GoogleAuthProvider();
                signInWithPopup(auth, provider).catch(error => console.error("Google sign-in failed:", error));
            }
        });
        
        // --- DATA MANAGEMENT (FIRESTORE) ---
        async function initializeUserData(user) {
            const userDocRef = doc(db, `artifacts/${appId}/users`, userId);
            
            userDocUnsubscribe = onSnapshot(userDocRef, (docSnap) => {
                if (docSnap.exists()) {
                    creditCountEl.textContent = docSnap.data().credits;
                }
            });

            const docSnap = await getDoc(userDocRef);
            if (!docSnap.exists()) {
                const isNewSignUp = !user.isAnonymous && user.metadata.creationTime === user.metadata.lastSignInTime;
                const initialCredits = user.isAnonymous ? FREE_TOKENS_ANONYMOUS : (isNewSignUp ? FREE_TOKENS_ON_SIGNUP + FREE_TOKENS_ANONYMOUS : FREE_TOKENS_ANONYMOUS);
                
                await setDoc(userDocRef, {
                    email: user.email || 'anonymous',
                    createdAt: new Date(),
                    credits: initialCredits
                });
                showToast(`Welcome! You have received ${initialCredits} free credits.`);
            }
        }
        
        // --- CORE LOGIC: USING & BUYING CREDITS ---
        async function useCredits(cost) {
            if (!userId) {
                showToast("Please wait, initializing user...", true);
                return false;
            }

            const userDocRef = doc(db, `artifacts/${appId}/users`, userId);
            const docSnap = await getDoc(userDocRef);

            if (docSnap.exists() && docSnap.data().credits >= cost) {
                await updateDoc(userDocRef, { credits: increment(-cost) });
                return true;
            } else {
                showToast("Not enough credits. Please buy a pack.", true);
                document.getElementById('pricing-section').scrollIntoView({ behavior: 'smooth' });
                return false;
            }
        }

        async function purchaseCredits(amount) {
            if (!userId || (currentUser && currentUser.isAnonymous)) {
                showToast("Please login with Google to purchase credits.", true);
                if (!currentUser || currentUser.isAnonymous) authButton.click();
                return;
            }

            showToast("Processing purchase...", false);
            const userDocRef = doc(db, `artifacts/${appId}/users`, userId);
            await updateDoc(userDocRef, { credits: increment(amount) });

            setTimeout(() => {
                 showToast(`Successfully added ${amount} credits to your account!`, false);
            }, 1000);
        }

        // --- EVENT LISTENERS ---
        document.querySelectorAll('.use-tool-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                if(currentUser && currentUser.isAnonymous && e.target.closest('.tool-card').querySelector('.locked-overlay')){
                    showToast("Please login to use premium tools.", true);
                    authButton.click();
                    return;
                }
                const cost = parseInt(e.target.dataset.cost, 10);
                const name = e.target.dataset.name;

                modalTitle.textContent = name;
                modalCreditCost.textContent = `${cost}`;
                modalDownloadBtn.dataset.cost = cost;

                downloadModal.classList.remove('hidden');
                downloadModal.classList.add('flex');
            });
        });
        
        modalCloseBtn.addEventListener('click', () => {
            downloadModal.classList.add('hidden');
            downloadModal.classList.remove('flex');
        });

        modalDownloadBtn.addEventListener('click', async () => {
            const cost = parseInt(modalDownloadBtn.dataset.cost, 10);
            const success = await useCredits(cost);
            if (success) {
                showToast(`Download started! ${cost} credit(s) used.`, false);
                downloadModal.classList.add('hidden');
                downloadModal.classList.remove('flex');
            }
        });

        document.querySelectorAll('.buy-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                const credits = parseInt(e.target.dataset.credits, 10);
                purchaseCredits(credits);
            });
        });


    // --- State & Global DOM elements ---
    const { PDFDocument, rgb, StandardFonts } = PDFLib;
    const uploadSelection = document.getElementById('uploadSelection');
    const processingArea = document.getElementById('processingArea');
    const uploadArea = document.getElementById('uploadArea');
    const fileUploadInput = document.getElementById('fileUploadInput');
    const deviceBtn = document.getElementById('deviceBtn');
    const urlBtn = document.getElementById('urlBtn');
    const clipboardBtn = document.getElementById('clipboardBtn');
    const cloudBtns = document.querySelectorAll('.cloud-btn');
    const urlModal = document.getElementById('urlModal');
    const urlInput = document.getElementById('urlInput');
    const cancelUrlBtn = document.getElementById('cancelUrlBtn');
    const submitUrlBtn = document.getElementById('submitUrlBtn');
    const comingSoonModal = document.getElementById('comingSoonModal');
    
    let currentFiles = [];
    let compressionResults = [];
    let processedFileCount = 0;
    let isLoggedIn = false;

    const homeLink = document.getElementById('homeLink');
    const allToolsLink = document.getElementById('allToolsLink');
    const allMainSections = document.querySelectorAll('.main-section');
    const genericToolSection = document.getElementById('generic-tool-section');
    const toolTitle = document.getElementById('tool-title');
    const toolSubtitle = document.getElementById('tool-subtitle');
    const toolContent = document.getElementById('tool-content');
    const toolLinks = document.querySelectorAll('.tool-link, .tool-card');
    
    // Auth elements
    const loginBtn = document.getElementById('loginBtn');
    const signupBtn = document.getElementById('signupBtn');
    const logoutBtn = document.getElementById('logoutBtn');
    const loginModal = document.getElementById('loginModal');
    const signupModal = document.getElementById('signupModal');
    const authLinks = document.getElementById('auth-links');
    const accountLinks = document.getElementById('account-links');
    
    // --- Main App Logic ---

    function showMainSection(sectionId) {
        allMainSections.forEach(section => {
            if (section.id === sectionId) {
                section.classList.remove('hidden');
            } else {
                section.classList.add('hidden');
            }
        });
        window.scrollTo(0, 0);
    }
    
    function activateTool(toolName) {
        if (toolName === 'compressor') {
            showMainSection('compressor');
            resetUI();
            return;
        }

        showMainSection('generic-tool-section');
        toolTitle.textContent = toolName;
        toolContent.innerHTML = '';

        if (toolName === 'JPG to PDF') {
            toolSubtitle.textContent = 'Convert JPG images to a single PDF file.';
            toolContent.innerHTML = `
                <div class="text-center">
                    <input type="file" id="jpgToPdfInput" class="hidden" accept="image/jpeg,image/png" multiple>
                    <button id="jpgToPdfBtn" class="p-4 bg-indigo-600 text-white rounded-lg shadow-sm hover:bg-indigo-700 font-semibold">Select Images</button>
                    <div id="jpgToPdfPreview" class="mt-4 grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-2"></div>
                    <div id="jpgToPdfAction" class="mt-6"></div>
                </div>
            `;
            const input = document.getElementById('jpgToPdfInput');
            const btn = document.getElementById('jpgToPdfBtn');
            btn.addEventListener('click', () => input.click());
            input.addEventListener('change', handleJpgToPdfUpload);
        } else {
            toolSubtitle.textContent = `Functionality for ${toolName} is coming soon.`;
            toolContent.innerHTML = `<p class="text-center text-slate-500">This feature is currently under development. Check back later!</p>`;
        }
    }
    
    async function handleJpgToPdfUpload(event) {
        const files = event.target.files;
        if (!files || files.length === 0) return;

        const previewContainer = document.getElementById('jpgToPdfPreview');
        previewContainer.innerHTML = '';
        Array.from(files).forEach(file => {
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = document.createElement('img');
                img.src = e.target.result;
                img.className = 'w-full h-24 object-cover rounded-md border';
                previewContainer.appendChild(img);
            };
            reader.readAsDataURL(file);
        });

        const actionContainer = document.getElementById('jpgToPdfAction');
        actionContainer.innerHTML = `<button id="createPdfBtn" class="p-4 bg-green-600 text-white rounded-lg shadow-sm hover:bg-green-700 font-semibold">Create PDF</button>`;
        document.getElementById('createPdfBtn').addEventListener('click', async () => {
            const btn = document.getElementById('createPdfBtn');
            btn.disabled = true;
            btn.innerHTML = `<span class="animate-pulse">Creating PDF...</span>`;

            const pdfDoc = await PDFDocument.create();
            for (const file of files) {
                const page = pdfDoc.addPage();
                const arrayBuffer = await file.arrayBuffer();
                let image;
                if (file.type === 'image/png') {
                    image = await pdfDoc.embedPng(arrayBuffer);
                } else {
                    image = await pdfDoc.embedJpg(arrayBuffer);
                }
                
                const { width, height } = image.scale(1);
                const pageWidth = page.getWidth();
                const pageHeight = page.getHeight();
                const scale = Math.min(pageWidth / width, pageHeight / height);
                
                page.drawImage(image, {
                    x: (pageWidth - width * scale) / 2,
                    y: (pageHeight - height * scale) / 2,
                    width: width * scale,
                    height: height * scale,
                });
            }

            const pdfBytes = await pdfDoc.save();
            const blob = new Blob([pdfBytes], { type: 'application/pdf' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'SwiftTools-Converted.pdf';
            link.className = 'inline-block bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-blue-700';
            link.textContent = 'Download PDF';
            actionContainer.innerHTML = '';
            actionContainer.appendChild(link);
        });
    }

    // --- Authentication Logic (Simulated) ---
    function updateNavForAuthState(loggedInState) {
        isLoggedIn = loggedInState;
        if (isLoggedIn) {
            authLinks.classList.add('hidden');
            accountLinks.classList.remove('hidden');
        } else {
            authLinks.classList.remove('hidden');
            accountLinks.classList.add('hidden');
        }
    }

    loginBtn.addEventListener('click', () => loginModal.classList.remove('hidden'));
    signupBtn.addEventListener('click', () => signupModal.classList.remove('hidden'));
    logoutBtn.addEventListener('click', () => {
        updateNavForAuthState(false);
        showMainSection('compressor');
    });

    document.querySelectorAll('.modal-close-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            btn.closest('.modal').classList.add('hidden');
        });
    });

    document.getElementById('loginForm').addEventListener('submit', (e) => {
        e.preventDefault();
        updateNavForAuthState(true);
        loginModal.classList.add('hidden');
    });
     document.getElementById('signupForm').addEventListener('submit', (e) => {
        e.preventDefault();
        updateNavForAuthState(true);
        signupModal.classList.add('hidden');
    });
    
    // --- Event Listeners ---
    homeLink.addEventListener('click', (e) => {
        e.preventDefault();
        showMainSection('compressor');
        resetUI();
    });

    allToolsLink.addEventListener('click', (e) => {
        e.preventDefault();
        showMainSection('all-tools');
    });

    toolLinks.forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            const tool = link.dataset.tool;
            if (tool === 'compressor') {
                activateTool('compressor');
            } else {
                if (isLoggedIn) {
                    activateTool(tool);
                } else {
                    signupModal.classList.remove('hidden');
                }
            }
        });
    });

    document.querySelectorAll('.coming-soon-btn').forEach(btn => btn.addEventListener('click', (e) => {
         e.preventDefault();
         comingSoonModal.classList.remove('hidden');
    }));

    // --- All Compressor Javascript ---
    const formatBytes = (bytes, decimals = 2) => {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const dm = decimals < 0 ? 0 : decimals;
        const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
    };

    function renderProcessingUI() {
        if (currentFiles.length === 0) {
            resetUI();
            return;
        }
        uploadSelection.classList.add('hidden');
        if (currentFiles.length === 1) {
            showSingleFileUI(currentFiles[0]);
        } else {
            showBatchUI();
        }
    }

    function showSingleFileUI(file) {
        let previewHTML = '';
        if (file.type.startsWith('image/')) {
            previewHTML = `<img src="${URL.createObjectURL(file)}" alt="File preview" class="max-h-48 w-auto object-contain rounded-md mx-auto">`;
        } else {
            previewHTML = `<div class="text-8xl text-center py-10">📄</div>`;
        }
        
        const isJPEG = file.type === 'image/jpeg';
        
        processingArea.innerHTML = `
            <div class="grid md:grid-cols-2 gap-8">
                <div class="space-y-4 text-center md:text-left">
                    <h2 class="text-xl font-bold text-slate-800">Your File</h2>
                    <div class="bg-slate-50 p-4 rounded-lg border">${previewHTML}</div>
                    <div class="text-sm">
                        <p class="font-semibold truncate">${file.name}</p>
                        <p class="text-slate-500">${formatBytes(file.size)}</p>
                    </div>
                    <button id="resetBtn" class="w-full md:w-auto bg-white hover:bg-slate-100 border border-slate-300 text-slate-700 font-semibold py-2 px-4 rounded-lg text-sm">Start Over</button>
                </div>
                <div class="space-y-6">
                    <div>
                        <h2 class="text-xl font-bold text-slate-800">Compression Level</h2>
                        <div id="compressionLevels" class="space-y-3 mt-3">
                            <label class="block p-3 rounded-lg border-2 border-slate-200 cursor-pointer has-[:checked]:border-indigo-600 has-[:checked]:ring-1 has-[:checked]:ring-indigo-500 smooth-transition">
                                <input type="radio" name="compression-level" value="extreme" class="hidden">
                                <span class="font-semibold text-sm block">Extreme Compression</span>
                                <span class="text-xs text-slate-500">Less quality, high compression.</span>
                            </label>
                            <label class="block p-3 rounded-lg border-2 border-slate-200 cursor-pointer has-[:checked]:border-indigo-600 has-[:checked]:ring-1 has-[:checked]:ring-indigo-500 smooth-transition">
                                <input type="radio" name="compression-level" value="recommended" class="hidden" checked>
                                <span class="font-semibold text-sm block">Recommended Compression</span>
                                <span class="text-xs text-slate-500">Good quality, good compression.</span>
                            </label>
                            <label class="block p-3 rounded-lg border-2 border-slate-200 cursor-pointer has-[:checked]:border-indigo-600 has-[:checked]:ring-1 has-[:checked]:ring-indigo-500 smooth-transition">
                                <input type="radio" name="compression-level" value="less" class="hidden">
                                <span class="font-semibold text-sm block">Less Compression</span>
                                <span class="text-xs text-slate-500">High quality, less compression.</span>
                            </label>
                        </div>
                    </div>
                    
                    <div id="targetSizeSection" class="${isJPEG ? '' : 'hidden'}">
                        <div class="relative"><div class="absolute inset-0 flex items-center"><div class="w-full border-t border-slate-300"></div></div><div class="relative flex justify-center text-sm"><span class="px-2 bg-white text-slate-500">OR</span></div></div>
                        <div class="mt-4">
                            <label for="targetSizeSelect" class="block text-sm font-medium text-slate-600">Select Target Size</label>
                            <select id="targetSizeSelect" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 text-sm p-2">
                                <option value="">-- Select --</option>
                                <option value="51200">~50 KB</option>
                                <option value="102400">~100 KB</option>
                                <option value="512000">~500 KB</option>
                                <option value="1048576">~1 MB</option>
                            </select>
                        </div>
                        <div class="mt-4">
                            <label for="manualSizeInput" class="block text-sm font-medium text-slate-600">Manually Enter Size (KB)</label>
                            <input type="number" id="manualSizeInput" placeholder="e.g., 150" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 text-sm p-2">
                        </div>
                    </div>

                    <div>
                         <button id="compressBtn" class="w-full mt-4 flex items-center justify-center text-center p-4 bg-indigo-600 text-white rounded-lg shadow-sm hover:bg-indigo-700 smooth-transition font-semibold text-lg">Compress File</button>
                    </div>
                </div>
            </div>
            <div id="resultArea" class="mt-8"></div>
        `;
        processingArea.classList.remove('hidden');
        addProcessingEventListeners();
    }

    function showBatchUI() {
        const fileListHTML = currentFiles.map((file, index) => {
            const fileIcon = file.type.startsWith('image/') 
                ? `<img src="${URL.createObjectURL(file)}" alt="preview" class="w-10 h-10 object-cover rounded-md">`
                : `<div class="w-10 h-10 flex items-center justify-center bg-slate-200 rounded-md text-xl">📄</div>`;
            return `
                <div id="file-row-${index}" class="p-2 grid grid-cols-4 gap-2 items-center text-sm border-b">
                    <div class="flex items-center gap-2 col-span-2">
                        ${fileIcon}
                        <div><p class="font-semibold truncate">${file.name}</p><p class="text-slate-500 text-xs">${formatBytes(file.size)}</p></div>
                    </div>
                    <div id="file-result-${index}" class="col-span-2 text-right"><span class="text-slate-400">Pending...</span></div>
                </div>`;
        }).join('');

        processingArea.innerHTML = `
            <div class="grid lg:grid-cols-3 gap-8">
                <div class="lg:col-span-2">
                    <div class="flex justify-between items-center mb-2">
                        <h2 class="text-xl font-bold text-slate-800">Your Files (${currentFiles.length})</h2>
                        <div class="flex gap-2">
                             <button id="addMoreBtn" class="text-sm text-indigo-600 hover:text-indigo-800 font-semibold">Add More</button>
                             <button id="clearAllBtn" class="text-sm text-red-600 hover:text-red-800 font-semibold">Clear All</button>
                        </div>
                    </div>
                    <div class="bg-white border rounded-lg max-h-96 overflow-y-auto">${fileListHTML}</div>
                    <div id="zipDownloadArea" class="mt-4 text-center"></div>
                </div>
                <div class="space-y-6">
                    <h2 class="text-xl font-bold text-slate-800">Compression Level</h2>
                    <div class="space-y-3">
                        <label class="block p-3 rounded-lg border-2 border-slate-200 cursor-pointer has-[:checked]:border-indigo-600 has-[:checked]:ring-1 has-[:checked]:ring-indigo-500"><input type="radio" name="compression-level" value="extreme" class="hidden"><span class="font-semibold text-sm block">Extreme</span><span class="text-xs text-slate-500">High compression</span></label>
                        <label class="block p-3 rounded-lg border-2 border-slate-200 cursor-pointer has-[:checked]:border-indigo-600 has-[:checked]:ring-1 has-[:checked]:ring-indigo-500"><input type="radio" name="compression-level" value="recommended" class="hidden" checked><span class="font-semibold text-sm block">Recommended</span><span class="text-xs text-slate-500">Good quality</span></label>
                        <label class="block p-3 rounded-lg border-2 border-slate-200 cursor-pointer has-[:checked]:border-indigo-600 has-[:checked]:ring-1 has-[:checked]:ring-indigo-500"><input type="radio" name="compression-level" value="less" class="hidden"><span class="font-semibold text-sm block">Less</span><span class="text-xs text-slate-500">High quality</span></label>
                    </div>
                    <div><button id="compressBtn" class="w-full mt-4 flex items-center justify-center text-center p-4 bg-indigo-600 text-white rounded-lg shadow-sm hover:bg-indigo-700 font-semibold text-lg">Compress All Files</button></div>
                </div>
            </div>`;
        processingArea.classList.remove('hidden');
        addProcessingEventListeners();
    }
    
    function showSingleResult(originalFile, compressedSize, compressedBlob) {
        const resultArea = document.getElementById('resultArea');
        if (compressedSize >= originalFile.size) {
            resultArea.innerHTML = `<div class="bg-amber-50 border-2 border-dashed border-amber-200 rounded-xl p-6 text-center">
                <h3 class="text-xl font-bold text-amber-800">No Savings Achieved</h3>
                <p class="text-sm text-amber-600 mt-2">The file is already optimized. You can download the original instead.</p>
                <div class="flex justify-center gap-6 md:gap-12 my-4 text-sm">
                    <div><div class="text-slate-500">Original</div><div class="font-bold text-lg">${formatBytes(originalFile.size)}</div></div>
                    <div><div class="text-slate-500">"Compressed"</div><div class="font-bold text-lg text-amber-700">${formatBytes(compressedSize)}</div></div>
                </div>
                <div class="text-center mb-4">
                    <a href="${URL.createObjectURL(originalFile)}" download="${originalFile.name}" class="inline-block bg-amber-500 text-white font-semibold py-2 px-6 rounded-lg hover:bg-amber-600">Download Original</a>
                </div>
                <div class="relative my-4"><div class="absolute inset-0 flex items-center"><div class="w-full border-t border-slate-300"></div></div><div class="relative flex justify-center text-sm"><span class="px-2 bg-amber-50 text-slate-500">Save & Share Original</span></div></div>
                <div class="flex justify-center gap-2 flex-wrap">
                    <button class="coming-soon-feature-btn flex items-center p-2 bg-white hover:bg-slate-100 border rounded-lg text-xs font-medium"><img src="https://placehold.co/20x20/4285F4/FFFFFF?text=G" class="w-5 h-5 mr-2" alt="Google Drive icon"> Save to Drive</button>
                    <button class="coming-soon-feature-btn flex items-center p-2 bg-white hover:bg-slate-100 border rounded-lg text-xs font-medium"><img src="https://placehold.co/20x20/0061FE/FFFFFF?text=D" class="w-5 h-5 mr-2" alt="Dropbox icon"> Save to Dropbox</button>
                    <button class="coming-soon-feature-btn flex items-center p-2 bg-white hover:bg-slate-100 border rounded-lg text-xs font-medium"><svg class="w-5 h-5 mr-2 text-green-500" fill="currentColor" viewBox="0 0 24 24"><path d="M16.6 14.2c-.3-.2-1.8-.9-2.1-1s-.5-.2-.7.2c-.2.4-.8 1-.9 1.2-.2.2-.3.2-.6.1s-1.1-.4-2.1-1.3c-.8-.7-1.3-1.6-1.5-1.8c-.2-.2 0-.3.1-.4s.2-.2.4-.4c.1-.1.2-.2.2-.4c.1-.2 0-.4-.1-.5s-.7-1.8-.9-2.4c-.2-.6-.4-.5-.6-.5h-.5c-.2 0-.5.2-.7.6c-.2.4-.8 1-.8 2.4c0 1.4.8 2.8 1 3s1.6 1.9 3.9 3.3c2.3 1.3 2.3.9 2.7.9c.4 0 1.2-.5 1.4-1s.6-1.1.7-1.2c.1-.2.1-.4 0-.5l-.3-.5zM12 2C6.5 2 2 6.5 2 12s4.5 10 10 10s10-4.5 10-10S17.5 2 12 2zm0 18c-4.4 0-8-3.6-8-8s3.6-8 8-8s8 3.6 8 8s-3.6 8-8 8z"/></svg>Share on WhatsApp</button>
                </div>
            </div>`;
        } else {
            const savings = 100 - (compressedSize / originalFile.size * 100);
            resultArea.innerHTML = `<div class="bg-green-50 border-2 border-dashed border-green-200 rounded-xl p-6">
                <h3 class="text-xl font-bold text-green-800 text-center">Compression Complete!</h3>
                <div class="flex justify-center gap-6 md:gap-12 my-4 text-sm">
                    <div><div class="text-slate-500">Original</div><div class="font-bold text-lg">${formatBytes(originalFile.size)}</div></div>
                    <div><div class="text-slate-500">Compressed</div><div class="font-bold text-lg text-green-700">${formatBytes(compressedSize)}</div></div>
                    <div><div class="text-slate-500">Savings</div><div class="font-bold text-lg text-green-700">${savings.toFixed(1)}%</div></div>
                </div>
                <div class="text-center mb-4">
                    <a href="${URL.createObjectURL(compressedBlob)}" download="${getCompressedFileName(originalFile.name)}" class="inline-block bg-green-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-green-700">Download File</a>
                </div>
                <div class="relative my-4"><div class="absolute inset-0 flex items-center"><div class="w-full border-t border-slate-300"></div></div><div class="relative flex justify-center text-sm"><span class="px-2 bg-green-50 text-slate-500">Save & Share</span></div></div>
                <div class="flex justify-center gap-2 flex-wrap">
                    <button class="coming-soon-feature-btn flex items-center p-2 bg-white hover:bg-slate-100 border rounded-lg text-xs font-medium"><img src="https://placehold.co/20x20/4285F4/FFFFFF?text=G" class="w-5 h-5 mr-2" alt="Google Drive icon"> Save to Drive</button>
                    <button class="coming-soon-feature-btn flex items-center p-2 bg-white hover:bg-slate-100 border rounded-lg text-xs font-medium"><img src="https://placehold.co/20x20/0061FE/FFFFFF?text=D" class="w-5 h-5 mr-2" alt="Dropbox icon"> Save to Dropbox</button>
                    <button class="coming-soon-feature-btn flex items-center p-2 bg-white hover:bg-slate-100 border rounded-lg text-xs font-medium"><svg class="w-5 h-5 mr-2 text-green-500" fill="currentColor" viewBox="0 0 24 24"><path d="M16.6 14.2c-.3-.2-1.8-.9-2.1-1s-.5-.2-.7.2c-.2.4-.8 1-.9 1.2-.2.2-.3.2-.6.1s-1.1-.4-2.1-1.3c-.8-.7-1.3-1.6-1.5-1.8c-.2-.2 0-.3.1-.4s.2-.2.4-.4c.1-.1.2-.2.2-.4c.1-.2 0-.4-.1-.5s-.7-1.8-.9-2.4c-.2-.6-.4-.5-.6-.5h-.5c-.2 0-.5.2-.7.6c-.2.4-.8 1-.8 2.4c0 1.4.8 2.8 1 3s1.6 1.9 3.9 3.3c2.3 1.3 2.3.9 2.7.9c.4 0 1.2-.5 1.4-1s.6-1.1.7-1.2c.1-.2.1-.4 0-.5l-.3-.5zM12 2C6.5 2 2 6.5 2 12s4.5 10 10 10s10-4.5 10-10S17.5 2 12 2zm0 18c-4.4 0-8-3.6-8-8s3.6-8 8-8s8 3.6 8 8s-3.6 8-8 8z"/></svg>Share on WhatsApp</button>
                </div>
            </div>`;
        }
        document.getElementById('compressBtn').disabled = true;
        document.getElementById('compressBtn').textContent = 'Completed';
        addResultEventListeners();
    }

    function updateFileResultInList(index, originalFile, compressedSize, compressedBlob) {
        const resultContainer = document.getElementById(`file-result-${index}`);
        compressionResults[index] = { originalFile, compressedSize, compressedBlob, name: getCompressedFileName(originalFile.name) };
        processedFileCount++;

        if (compressedSize >= originalFile.size) {
            resultContainer.innerHTML = `<div class="text-right"><p class="font-semibold text-amber-600">${formatBytes(compressedSize)}</p><p class="text-xs text-amber-500">No Savings</p></div>`;
            compressionResults[index].compressedBlob = originalFile;
            compressionResults[index].name = originalFile.name;
        } else {
            const savings = 100 - (compressedSize / originalFile.size * 100);
            resultContainer.innerHTML = `<div class="flex items-center justify-end gap-4"><div><p class="font-semibold text-green-700">${formatBytes(compressedSize)}</p><p class="text-xs text-green-600">${savings.toFixed(1)}% Saved</p></div><a href="${URL.createObjectURL(compressedBlob)}" download="${getCompressedFileName(originalFile.name)}" class="p-2 rounded-md hover:bg-slate-100"><svg class="w-5 h-5 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg></a></div>`;
        }

        if (processedFileCount === currentFiles.length) {
            document.getElementById('compressBtn').disabled = true;
            document.getElementById('compressBtn').textContent = 'Completed';
            document.getElementById('zipDownloadArea').innerHTML = `<button id="downloadZipBtn" class="w-full md:w-auto bg-green-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-green-700">Download All (.zip)</button>`;
            document.getElementById('downloadZipBtn').addEventListener('click', createAndDownloadZip);
        }
    }

    function resetUI() {
        currentFiles = [];
        compressionResults = [];
        processedFileCount = 0;
        fileUploadInput.value = '';
        uploadSelection.classList.remove('hidden');
        processingArea.classList.add('hidden');
        processingArea.innerHTML = '';
    }
    
    uploadArea.addEventListener('dragover', (e) => { e.preventDefault(); uploadArea.classList.add('drag-area-highlight'); });
    uploadArea.addEventListener('dragleave', (e) => { e.preventDefault(); uploadArea.classList.remove('drag-area-highlight'); });
    uploadArea.addEventListener('drop', (e) => { e.preventDefault(); uploadArea.classList.remove('drag-area-highlight'); if (e.dataTransfer.files) handleFiles(e.dataTransfer.files); });
    deviceBtn.addEventListener('click', () => fileUploadInput.click());
    fileUploadInput.addEventListener('change', (e) => { if (e.target.files) handleFiles(e.target.files); });
    
    urlBtn.addEventListener('click', () => urlModal.classList.remove('hidden'));
    cancelUrlBtn.addEventListener('click', () => urlModal.classList.add('hidden'));
    submitUrlBtn.addEventListener('click', async () => {
        const url = urlInput.value.trim();
        if (!url) return;
        try {
            submitUrlBtn.disabled = true; submitUrlBtn.textContent = 'Fetching...';
            const response = await fetch(url);
            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            const blob = await response.blob();
            const fileName = url.substring(url.lastIndexOf('/') + 1) || 'file-from-url';
            const file = new File([blob], fileName, { type: blob.type });
            handleFiles([file]);
            urlModal.classList.add('hidden');
        } catch (error) { console.error("URL fetch failed:", error); alert("Sorry, could not fetch the file.");
        } finally { submitUrlBtn.disabled = false; submitUrlBtn.textContent = 'Fetch File'; }
    });

    clipboardBtn.addEventListener('click', async () => {
        try {
            const clipboardItems = await navigator.clipboard.read();
            for (const item of clipboardItems) { for (const type of item.types) { if (type.startsWith('image/')) {
                const blob = await item.getType(type);
                const file = new File([blob], `pasted-image.${type.split('/')[1]}`, { type });
                handleFiles([file]); return;
            }}}
            alert("No image found on clipboard.");
        } catch (err) { console.error(err); alert("Could not read from clipboard."); }
    });

    cloudBtns.forEach(btn => btn.addEventListener('click', () => alert('Cloud storage integration is coming soon!')));

    function addResultEventListeners() {
        const featureBtns = document.querySelectorAll('.coming-soon-feature-btn');
        featureBtns.forEach(btn => btn.addEventListener('click', () => comingSoonModal.classList.remove('hidden')));
    }

    function addProcessingEventListeners() {
        const resetButton = document.getElementById('resetBtn');
        const clearAllButton = document.getElementById('clearAllBtn');
        const addMoreButton = document.getElementById('addMoreBtn');
        const compressButton = document.getElementById('compressBtn');

        if(resetButton) resetButton.addEventListener('click', resetUI);
        if(clearAllButton) clearAllButton.addEventListener('click', resetUI);
        if(addMoreButton) addMoreButton.addEventListener('click', () => fileUploadInput.click());
        if(compressButton) compressButton.addEventListener('click', processCompression);

        const targetSizeSelect = document.getElementById('targetSizeSelect');
        const manualSizeInput = document.getElementById('manualSizeInput');
        const compressionLevels = document.getElementById('compressionLevels');

        const handleTargetSizeChange = () => {
             if (compressionLevels) {
                compressionLevels.querySelectorAll('input').forEach(radio => {
                    radio.checked = false;
                    radio.closest('label').classList.add('opacity-50');
                });
            }
        };

        const handleLevelChange = () => {
            if (targetSizeSelect) targetSizeSelect.value = '';
            if (manualSizeInput) manualSizeInput.value = '';
            if (compressionLevels) {
                 compressionLevels.querySelectorAll('label').forEach(label => label.classList.remove('opacity-50'));
            }
        }
        
        if (targetSizeSelect) {
            targetSizeSelect.addEventListener('change', () => {
                if (manualSizeInput) manualSizeInput.value = '';
                handleTargetSizeChange();
            });
        }
        if (manualSizeInput) {
            manualSizeInput.addEventListener('input', () => {
                if (targetSizeSelect) targetSizeSelect.value = '';
                handleTargetSizeChange();
            });
        }
        if (compressionLevels) {
            compressionLevels.addEventListener('change', handleLevelChange);
        }
    }

    function handleFiles(files) {
        const newFiles = Array.from(files);
        currentFiles.push(...newFiles);
        compressionResults = new Array(currentFiles.length).fill(null);
        renderProcessingUI();
    }
    
    function getCompressedFileName(originalName) {
        const dotIndex = originalName.lastIndexOf('.');
        const name = dotIndex > -1 ? originalName.substring(0, dotIndex) : originalName;
        if (originalName.endsWith('.png')) return `${name}-compressed.png`;
        if (originalName.match(/\.(jpeg|jpg)$/i)) return `${name}-compressed.jpg`;
        return `${name}.gz`;
    }

    function processCompression() {
        if(currentFiles.length === 1) {
            processSingleFileCompression();
        } else if (currentFiles.length > 1) {
            processBatchCompression();
        }
    }

    async function processSingleFileCompression() {
        const compressBtn = document.getElementById('compressBtn');
        compressBtn.disabled = true;
        compressBtn.innerHTML = '<span class="animate-pulse">Compressing...</span>';

        const file = currentFiles[0];
        const targetSizeSelect = document.getElementById('targetSizeSelect');
        const manualSizeInput = document.getElementById('manualSizeInput');

        let targetSize = null;
        if (targetSizeSelect && targetSizeSelect.value) {
            targetSize = parseInt(targetSizeSelect.value, 10);
        } else if (manualSizeInput && manualSizeInput.value) {
            targetSize = parseInt(manualSizeInput.value, 10) * 1024; // Convert KB to Bytes
        }

        if (file.type === 'image/jpeg' && targetSize) {
             const reader = new FileReader();
             reader.onload = (e) => compressImage(e.target.result, null, 0, true, targetSize).catch(err => { console.error(err); resetUI(); });
             reader.readAsDataURL(file);
             return;
        }

        const selectedLevel = document.querySelector('input[name="compression-level"]:checked').value;
        if (file.type.startsWith('image/')) {
            const qualityMap = { extreme: 0.4, recommended: 0.7, less: 0.9 };
            const quality = qualityMap[selectedLevel];
            const reader = new FileReader();
            reader.onload = (e) => compressImage(e.target.result, quality, 0, true).catch(err => { console.error(err); resetUI(); });
            reader.readAsDataURL(file);
        } else {
            const levelMap = { extreme: 9, recommended: 6, less: 3 };
            const level = levelMap[selectedLevel];
            const reader = new FileReader();
            reader.onload = (e) => compressGenericFile(e.target.result, level, 0, true);
            reader.readAsArrayBuffer(file);
        }
    }

    async function processBatchCompression() {
        const compressBtn = document.getElementById('compressBtn');
        compressBtn.disabled = true;
        compressBtn.innerHTML = '<span class="animate-pulse">Compressing...</span>';
        
        const selectedLevel = document.querySelector('input[name="compression-level"]:checked').value;
        processedFileCount = 0;

        currentFiles.forEach((file, index) => {
            document.getElementById(`file-result-${index}`).innerHTML = `<span class="text-indigo-500 animate-pulse">Compressing...</span>`;
            if (file.type.startsWith('image/')) {
                const qualityMap = { extreme: 0.4, recommended: 0.7, less: 0.9 };
                const quality = qualityMap[selectedLevel];
                const reader = new FileReader();
                reader.onload = (e) => compressImage(e.target.result, quality, index, false).catch(err => { console.error(err); updateFileResultInList(index, file, file.size, file); });
                reader.readAsDataURL(file);
            } else {
                const levelMap = { extreme: 9, recommended: 6, less: 3 };
                const level = levelMap[selectedLevel];
                const reader = new FileReader();
                reader.onload = (e) => compressGenericFile(e.target.result, level, index, false);
                reader.readAsArrayBuffer(file);
            }
        });
    }
    
    async function compressImage(dataUrl, quality, index, isSingleMode, targetSize = null) {
        const file = currentFiles[index];
        const img = await new Promise((resolve, reject) => { const image = new Image(); image.src = dataUrl; image.onload = () => resolve(image); image.onerror = (err) => reject("Could not load image file."); });
        const canvas = document.createElement('canvas');
        canvas.width = img.width; canvas.height = img.height;
        const ctx = canvas.getContext('2d');
        ctx.drawImage(img, 0, 0, img.width, img.height);
        
        const mimeType = file.type === 'image/png' ? 'image/png' : 'image/jpeg';
        let blob;

        if(mimeType === 'image/jpeg' && targetSize) {
             let lowerBound = 0, upperBound = 1, bestBlob = null;
             const getBlobForQuality = q => new Promise(resolve => canvas.toBlob(resolve, mimeType, q));
             for (let i = 0; i < 8; i++) { // Binary search for quality
                 const currentQuality = (lowerBound + upperBound) / 2;
                 const currentBlob = await getBlobForQuality(currentQuality);
                 if (!currentBlob) continue;
                 if (currentBlob.size <= targetSize) { bestBlob = currentBlob; lowerBound = currentQuality; } else { upperBound = currentQuality; }
             }
             blob = bestBlob || await getBlobForQuality(0.1); // Fallback
        } else {
             blob = await new Promise(resolve => canvas.toBlob(resolve, mimeType, quality));
        }
        
        if (isSingleMode) {
            showSingleResult(file, blob.size, blob);
        } else {
            updateFileResultInList(index, file, blob.size, blob);
        }
    }
    
    function compressGenericFile(arrayBuffer, level, index, isSingleMode) {
        const file = currentFiles[index];
         try {
            const compressed = pako.gzip(new Uint8Array(arrayBuffer), { level });
            const blob = new Blob([compressed], { type: 'application/gzip' });
            if (isSingleMode) {
                showSingleResult(file, blob.size, blob);
            } else {
                updateFileResultInList(index, file, blob.size, blob);
            }
        } catch (error) {
            console.error("GZIP compression failed:", error);
            if(isSingleMode) { resetUI(); } else { updateFileResultInList(index, file, file.size, file); }
        }
    }

    async function createAndDownloadZip() {
        const zipBtn = document.getElementById('downloadZipBtn');
        zipBtn.disabled = true;
        zipBtn.innerHTML = '<span class="animate-pulse">Creating Zip...</span>';
        
        const zip = new JSZip();
        compressionResults.forEach(result => {
            if (result && result.compressedBlob) {
                zip.file(result.name, result.compressedBlob);
            }
        });
        
        const zipBlob = await zip.generateAsync({ type: "blob" });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(zipBlob);
        link.download = 'SwiftTools-Compressed-Files.zip';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        zipBtn.textContent = 'Downloaded!';
    }
    
    // Initialize the page view
    showMainSection('compressor');
    updateNavForAuthState(false); 
</script>
</body>
</html>


